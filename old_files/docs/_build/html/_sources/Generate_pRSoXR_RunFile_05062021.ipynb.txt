{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import pandas as pd\n",
    "import math"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Setup Parameters\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "##User inputs\n",
    "\n",
    "sample1 = pd.DataFrame({'Samp_B' : [270.0, 284.5, 287.3, 288.7]})\n",
    "sample2 = pd.DataFrame({'Samp_C' : [270.0, 284.5, 287.3, 288.7]})\n",
    "sample3 = pd.DataFrame({'Samp_D' : [270.0, 284.5, 287.3, 288.7]})\n",
    "#sample4 = pd.DataFrame({'Samp_F' : [270.0, 284.5, 287.3, 288.7]})\n",
    "#sample5 = pd.DataFrame({'Samp_G' : [270.0, 284.5, 287.3, 288.7]})\n",
    "#sample6 = pd.DataFrame({'Samp_A' : [270.0, 284.5, 287.3, 288.7]})\n",
    "\n",
    "##Sample / Position inputs \n",
    "EnergyOffset = 0 #Offset from any external energy calibrations.\n",
    "\n",
    "##Use a list to accomodate more than 1 sample \n",
    "XPosition = [36.52, 23.36, 0] # 'Sample X' motor position\n",
    "XOffset = [0.15, 0.15, 0.15] # Offset to translate beam on sample after each energy.\n",
    "YPosition = [-3.2150, -1.9750, 0] # 'Sample Y' motor position\n",
    "ZPosition = [-0.27, -0.36, 0] # 'Sample Z' motor position\n",
    "ZFlipPosition = [0.21, 0.15, 0] # 'Sample Z' motor position when 'Sample Theta' is flipped 180deg\n",
    "ReverseHolder = [0, 0, 0] #Set to True (1) for a sample that is on the reverse side of the holder\n",
    "ZDirectBeam = [-2, -2, -1] #'Sample Z' motor positions to access the direct beam\n",
    "ThetaOffset = [0, -0.55, 0] #'Sample Theta' offset if measuring multiple samples\n",
    "SampleThickness = [250, 250, 250] #Approximate film thickness [A], used to determine dq\n",
    "\n",
    "##\n",
    "LowAngleDensity = [15, 15, 15] #Approximate number of points per fringe at low angles\n",
    "HighAngleDensity = [9, 9, 9] #Approximate number of points per fringe at high angles\n",
    "AngleCrossover = [10, 10, 10] #Angle [deg] to cross from low -> high density\n",
    "##\n",
    "OverlapPoints = [3, 3, 3] #Number of overlap points upon changing motor. Used for stitching\n",
    "CheckUncertainty = [3, 3, 3] #Number of points for assessing error at each change in motor conditions. Used for error reduction\n",
    "HOSBuffer = [2, 2, 2] #Number of points to add upon changing HOS to account for  motor movement. \n",
    "I0Points = [10, 10, 10] #Number of I0 measureents taken at the start of the scan. Used to calculate direct beam uncertainty\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [],
   "source": [
    "sample_list = {}\n",
    "sample_list['Samp_B'] = [270.0, 284.5, 287.3, 288.7]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'Samp_B': [270.0, 284.5, 287.3, 288.7]}"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "sample_list"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [],
   "source": [
    "VariableMotors = []\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [],
   "source": [
    "\"\"\"\n",
    "COPY THIS BLOCK OF CODE FOR EACH SAMPLE\n",
    "\"\"\"\n",
    "#########################################\n",
    "#####            Sample 0           #####\n",
    "#########################################\n",
    "sample = 0 #The sample index\n",
    "DEG = [] # Angles to change settings\n",
    "HOS = [] # HOS positions\n",
    "HES = [] # HES positions\n",
    "EXP = [] # Exposures\n",
    "#########################################\n",
    "\n",
    "#########################################\n",
    "#####           Energy 1            #####\n",
    "#########################################\n",
    "DEG.append([1, 6, 10, 15, 20, 25, 30, 40, 75])\n",
    "HOS.append([12, 11, 10, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5])\n",
    "HES.append([150, 150, 150, 150, 150, 150, 150, 150, 150])\n",
    "EXP.append([0.001, 0.001, 0.001, 0.001, 0.1, 0.5, 0.5, 0.5, 0.5])\n",
    "\n",
    "#########################################\n",
    "#####           Energy 2            #####\n",
    "#########################################\n",
    "DEG.append([1, 4, 6, 10, 12, 15, 20, 25, 30, 40, 75])\n",
    "HOS.append([12, 11.5,  12, 10, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5])\n",
    "HES.append([1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500])\n",
    "EXP.append([0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.1, 0.1, 0.1, 0.1, 0.1])\n",
    "\n",
    "#########################################\n",
    "#####           Energy 3            #####\n",
    "#########################################\n",
    "DEG.append([1, 4, 6, 10, 12, 15, 20, 25, 30, 40, 75])\n",
    "HOS.append([12, 11.5,  12, 10, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5])\n",
    "HES.append([1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500])\n",
    "EXP.append([0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.1, 0.1, 0.1, 0.1, 0.1])\n",
    "\n",
    "#########################################\n",
    "#####           Energy 4            #####\n",
    "#########################################\n",
    "DEG.append([1, 4, 6, 10, 12, 15, 20, 25, 30, 40, 75])\n",
    "HOS.append([12, 11.5,  12, 10, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5])\n",
    "HES.append([1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500])\n",
    "EXP.append([0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.1, 0.1, 0.1, 0.1, 0.1])\n",
    "\n",
    "#Consolodate information\n",
    "motors = zip(DEG, HOS, HES, EXP)\n",
    "temp_list = []\n",
    "columns = ['Angle', 'HOS', 'HES', 'EXPOSURE']\n",
    "for deg, hos, hes, exp in motors:\n",
    "    temp_list.append(pd.DataFrame({'Angle':deg, 'HOS':hos, 'HES':hes, 'EXPOSURE':exp}))    \n",
    "VariableMotors.append(temp_list)\n",
    "\"\"\"\n",
    "STOP COPYING HERE\n",
    "\"\"\"\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [],
   "source": [
    "\"\"\"\n",
    "\n",
    "Angle ranges corresponding to changing motor positions  \n",
    "         **Need to define for each sample**\n",
    "Length of angle transitions list is 1 more than the corresponding motor positions\n",
    "len(AngleTransition_X)-1 = len(HOS_X) = len(HES_X) = Len(EXPOSURE_X) (For Sample X)\n",
    "\n",
    "\"\"\"\n",
    "#########################################\n",
    "#####            Sample 2           #####\n",
    "#########################################\n",
    "AngleTransition_S2E1 = [1, 6, 10, 15, 20, 25, 30, 40, 75] \n",
    "HOS_S2E1 =             [12, 11, 10, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5]\n",
    "HES_S2E1 =             [150, 150, 150, 150, 150, 150, 150, 150, 150]\n",
    "EXPOSURE_S2E1 =        [0.001, 0.001, 0.001, 0.001, 0.1, 0.5, 0.5, 0.5]\n",
    "\n",
    "####################################\n",
    "AngleTransition_S2E2 = [1, 4, 6, 10, 12, 15, 20, 25, 30, 40, 75]\n",
    "HOS_S2E2 =             [12, 11.5,  12, 10, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5]\n",
    "HES_S2E2 =             [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]\n",
    "EXPOSURE_S2E2 =        [0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.1, 0.1, 0.1, 0.1, 0.1]\n",
    "##################################\n",
    "\n",
    "AngleTransition_S2E3 = [1, 4, 6, 10, 15, 20, 25, 35, 40, 75]\n",
    "HOS_S2E3 =             [12, 11, 10, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5]\n",
    "HES_S2E3 =             [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]\n",
    "EXPOSURE_S2E3 =        [0.01, 0.01, 0.01, 0.01, 0.05, 0.05, 0.2, 0.5, 0.5]\n",
    "#################################\n",
    "\n",
    "AngleTransition_S2E4 = [1, 4, 6, 10, 15, 20, 25, 30, 40, 75] \n",
    "HOS_S2E4 =             [12, 11, 10, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5]\n",
    "HES_S2E4 =             [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]\n",
    "EXPOSURE_S2E4 =        [0.01, 0.01, 0.01, 0.01, 0.05, 0.05, 0.3, 0.2, 0.5]\n",
    "\n",
    "#AngleTransition_S1E5 = [1, 4, 6, 10, 15, 20, 25, 30, 40, 60]\n",
    "#HOS_S1E5 = [12, 11, 10, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5]\n",
    "#HES_S1E5 = [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]\n",
    "#EXPOSURE_S1E5 = [0.001, 0.001, 0.001, 0.001, 0.05, 0.1, 1, 1, 1, 1]\n",
    "\n",
    "#Consolodate lists\n",
    "##May need to update pending number of samples\n",
    "Sample2_En1 = pd.DataFrame([AngleTransition_S2E1, HOS_S2E1, HES_S2E1, EXPOSURE_S2E1]).T\n",
    "Sample2_En1.columns = ['Angle', 'HOS', 'HES', 'EXPOSURE']\n",
    "\n",
    "Sample2_En2 = pd.DataFrame([AngleTransition_S2E2, HOS_S2E2, HES_S2E2, EXPOSURE_S2E2]).T\n",
    "Sample2_En2.columns = ['Angle', 'HOS', 'HES', 'EXPOSURE']\n",
    "\n",
    "Sample2_En3 = pd.DataFrame([AngleTransition_S2E3, HOS_S2E3, HES_S2E3, EXPOSURE_S2E3]).T\n",
    "Sample2_En3.columns = ['Angle', 'HOS', 'HES', 'EXPOSURE']\n",
    "\n",
    "Sample2_En4 = pd.DataFrame([AngleTransition_S2E4, HOS_S2E4, HES_S2E4, EXPOSURE_S2E4]).T\n",
    "Sample2_En4.columns = ['Angle', 'HOS', 'HES', 'EXPOSURE']\n",
    "\n",
    "#Sample2_En5 = pd.DataFrame([AngleTransition_S2E5, HOS_S2E5, HES_S2E5, EXPOSURE_S2E5]).T\n",
    "#Sample2_En5.columns = ['Angle', 'HOS', 'HES', 'EXPOSURE']\n",
    "\n",
    "Sample2_motorpos = [Sample2_En1, Sample2_En2, Sample2_En3, Sample2_En4]#, Sample2_En5]\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [],
   "source": [
    "\"\"\"\n",
    "\n",
    "Angle ranges corresponding to changing motor positions  \n",
    "         **Need to define for each sample**\n",
    "Length of angle transitions list is 1 more than the corresponding motor positions\n",
    "len(AngleTransition_X)-1 = len(HOS_X) = len(HES_X) = Len(EXPOSURE_X) (For Sample X)\n",
    "\n",
    "\"\"\"\n",
    "#########################################\n",
    "#####            Sample 3           #####\n",
    "#########################################\n",
    "AngleTransition_S3E1 = [1, 6, 10, 15, 20, 25, 30, 40, 75]\n",
    "HOS_S3E1 =             [12, 11, 10, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5]\n",
    "HES_S3E1 =             [150, 150, 150, 150, 150, 150, 150, 150, 150]\n",
    "EXPOSURE_S3E1 =        [0.001, 0.001, 0.001, 0.001, 0.1, 0.5, 0.5, 0.5]\n",
    "\n",
    "AngleTransition_S3E2 = [1, 4, 6, 10, 12, 15, 20, 25, 30, 40, 75]\n",
    "HOS_S3E2 =             [12, 11.5,  12, 10, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5]\n",
    "HES_S3E2 =             [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]\n",
    "EXPOSURE_S3E2 =        [0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.1, 0.1, 0.1, 0.1, 0.1]\n",
    "\n",
    "AngleTransition_S3E3 = [1, 4, 6, 10, 15, 20, 25, 35, 40, 75]\n",
    "HOS_S3E3 =             [12, 11, 10, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5]\n",
    "HES_S3E3 =             [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]\n",
    "EXPOSURE_S3E3 =        [0.01, 0.01, 0.01, 0.01, 0.05, 0.05, 0.2, 0.5, 0.5]\n",
    "#################################\n",
    "\n",
    "AngleTransition_S3E4 = [1, 4, 6, 10, 15, 20, 25, 30, 40, 75]\n",
    "HOS_S3E4 =             [12, 11, 10, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5]\n",
    "HES_S3E4 =             [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]\n",
    "EXPOSURE_S3E4 =        [0.01, 0.01, 0.01, 0.01, 0.05, 0.05, 0.3, 0.2, 0.5]\n",
    "\n",
    "#AngleTransition_S2E5 = [1, 4, 6, 10, 15, 20, 25, 30, 40, 60]\n",
    "#HOS_S2E5 = [12, 11, 10, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5]\n",
    "#HES_S2E5 = [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]\n",
    "#EXPOSURE_S2E5 = [0.001, 0.001, 0.001, 0.001, 0.05, 0.1, 1, 1, 1, 1]\n",
    "\n",
    "#Consolodate lists\n",
    "##May need to update pending number of samples\n",
    "Sample3_En1 = pd.DataFrame([AngleTransition_S3E1, HOS_S3E1, HES_S3E1, EXPOSURE_S3E1]).T\n",
    "Sample3_En1.columns = ['Angle', 'HOS', 'HES', 'EXPOSURE']\n",
    "\n",
    "Sample3_En2 = pd.DataFrame([AngleTransition_S3E2, HOS_S3E2, HES_S3E2, EXPOSURE_S3E2]).T\n",
    "Sample3_En2.columns = ['Angle', 'HOS', 'HES', 'EXPOSURE']\n",
    "\n",
    "Sample3_En3 = pd.DataFrame([AngleTransition_S3E3, HOS_S3E3, HES_S3E3, EXPOSURE_S3E3]).T\n",
    "Sample3_En3.columns = ['Angle', 'HOS', 'HES', 'EXPOSURE']\n",
    "\n",
    "Sample3_En4 = pd.DataFrame([AngleTransition_S3E4, HOS_S3E4, HES_S3E4, EXPOSURE_S3E4]).T\n",
    "Sample3_En4.columns = ['Angle', 'HOS', 'HES', 'EXPOSURE']\n",
    "\n",
    "#Sample3_En5 = pd.DataFrame([AngleTransition_S3E5, HOS_S3E5, HES_S3E5, EXPOSURE_S3E5]).T\n",
    "#Sample3_En5.columns = ['Angle', 'HOS', 'HES', 'EXPOSURE']\n",
    "\n",
    "Sample3_motorpos = [Sample3_En1, Sample3_En2, Sample3_En3, Sample3_En4]#, Sample3_En5]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [],
   "source": [
    "\"\"\"\n",
    "\n",
    "Angle ranges corresponding to changing motor positions  \n",
    "         **Need to define for each sample**\n",
    "Length of angle transitions list is 1 more than the corresponding motor positions\n",
    "len(AngleTransition_X)-1 = len(HOS_X) = len(HES_X) = Len(EXPOSURE_X) (For Sample X)\n",
    "\n",
    "\"\"\"\n",
    "#########################################\n",
    "#####            Sample 4           ##### \n",
    "#########################################\n",
    "AngleTransition_S4E1 = [1, 4, 6, 10, 15, 20, 25, 30, 40, 60]  \n",
    "HOS_S4E1 = [12, 11.5, 10.5, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5]\n",
    "HES_S4E1 = [100, 100, 100, 100, 100, 100, 100, 100, 500, 1000]\n",
    "EXPOSURE_S4E1 = [0.001, 0.001, 0.001, 0.001, 0.05, 0.1, 0.5, 1, 1, 1]\n",
    "\n",
    "AngleTransition_S4E2 = [1, 4, 6, 10, 15, 20, 25, 30, 40, 50, 60]\n",
    "HOS_S4E2 = [12, 11, 10, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5]\n",
    "HES_S4E2 = [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1500, 1500, 1500, 1500]\n",
    "EXPOSURE_S4E2 = [0.005, 0.005, 0.005, 0.005, 0.05, 0.3, 1, 1, 1, 2, 2]\n",
    "\n",
    "AngleTransition_S4E3 = [1, 4, 6, 10, 15, 20, 25, 30, 40, 50, 60]\n",
    "HOS_S4E3 = [12, 11, 10, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5]\n",
    "HES_S4E3 = [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1500, 1500, 1500, 1500]\n",
    "EXPOSURE_S4E3 = [0.005, 0.005, 0.005, 0.005, 0.05, 0.3, 1, 1, 1, 2, 2]\n",
    "\n",
    "AngleTransition_S4E4 = [1, 4, 6, 10, 15, 20, 25, 30, 40, 60] \n",
    "HOS_S4E4 = [12, 11, 10, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5]\n",
    "HES_S4E4 = [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1500, 1500]\n",
    "EXPOSURE_S4E4 = [0.001, 0.001, 0.001, 0.001, 0.05, 0.2, 1, 1, 1, 1]\n",
    "\n",
    "#AngleTransition_S4E5 = [1, 4, 6, 10, 15, 20, 25, 30, 40, 60]\n",
    "#HOS_S4E5 = [12, 11, 10, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5]\n",
    "#HES_S4E5 = [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]\n",
    "#EXPOSURE_S4E5 = [0.001, 0.001, 0.001, 0.001, 0.05, 0.1, 1, 1, 1, 1]\n",
    "\n",
    "#Consolodate lists\n",
    "##May need to update pending number of samples\n",
    "Sample4_En1 = pd.DataFrame([AngleTransition_S4E1, HOS_S4E1, HES_S4E1, EXPOSURE_S4E1]).T\n",
    "Sample4_En1.columns = ['Angle', 'HOS', 'HES', 'EXPOSURE']\n",
    "\n",
    "Sample4_En2 = pd.DataFrame([AngleTransition_S4E2, HOS_S4E2, HES_S4E2, EXPOSURE_S4E2]).T\n",
    "Sample4_En2.columns = ['Angle', 'HOS', 'HES', 'EXPOSURE']\n",
    "\n",
    "Sample4_En3 = pd.DataFrame([AngleTransition_S4E3, HOS_S4E3, HES_S4E3, EXPOSURE_S4E3]).T\n",
    "Sample4_En3.columns = ['Angle', 'HOS', 'HES', 'EXPOSURE']\n",
    "\n",
    "Sample4_En4 = pd.DataFrame([AngleTransition_S4E4, HOS_S4E4, HES_S4E4, EXPOSURE_S4E4]).T\n",
    "Sample4_En4.columns = ['Angle', 'HOS', 'HES', 'EXPOSURE']\n",
    "\n",
    "#Sample4_En5 = pd.DataFrame([AngleTransition_S4E5, HOS_S4E5, HES_S4E5, EXPOSURE_S4E5]).T\n",
    "#Sample4_En5.columns = ['Angle', 'HOS', 'HES', 'EXPOSURE']\n",
    "\n",
    "Sample4_motorpos = [Sample4_En1, Sample4_En2, Sample4_En3, Sample4_En4]#, Sample4_En5]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [],
   "source": [
    "\"\"\"\n",
    "\n",
    "Angle ranges corresponding to changing motor positions  \n",
    "         **Need to define for each sample**\n",
    "Length of angle transitions list is 1 more than the corresponding motor positions\n",
    "len(AngleTransition_X)-1 = len(HOS_X) = len(HES_X) = Len(EXPOSURE_X) (For Sample X)\n",
    "\n",
    "\"\"\"\n",
    "#########################################\n",
    "#####            Sample 5           ##### \n",
    "#########################################\n",
    "AngleTransition_S5E1 = [1, 4, 6, 10, 15, 20, 25, 30, 40, 60]  \n",
    "HOS_S5E1 = [12, 11.5, 10.5, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5]\n",
    "HES_S5E1 = [100, 100, 100, 100, 100, 100, 100, 100, 500, 1000]\n",
    "EXPOSURE_S5E1 = [0.001, 0.001, 0.001, 0.001, 0.05, 0.1, 0.5, 1, 1, 1]\n",
    "\n",
    "AngleTransition_S5E2 = [1, 4, 6, 10, 15, 20, 25, 30, 40, 50, 60]\n",
    "HOS_S5E2 = [12, 11, 10, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5]\n",
    "HES_S5E2 = [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1500, 1500, 1500, 1500]\n",
    "EXPOSURE_S5E2 = [0.005, 0.005, 0.005, 0.005, 0.05, 0.3, 1, 1, 1, 2, 2]\n",
    "\n",
    "AngleTransition_S5E3 = [1, 4, 6, 10, 15, 20, 25, 30, 40, 50, 60]\n",
    "HOS_S5E3 = [12, 11, 10, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5]\n",
    "HES_S5E3 = [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1500, 1500, 1500, 1500]\n",
    "EXPOSURE_S5E3 = [0.005, 0.005, 0.005, 0.005, 0.05, 0.3, 1, 1, 1, 2, 2]\n",
    "\n",
    "AngleTransition_S5E4 = [1, 4, 6, 10, 15, 20, 25, 30, 40, 60] \n",
    "HOS_S5E4 = [12, 11, 10, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5]\n",
    "HES_S5E4 = [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1500, 1500]\n",
    "EXPOSURE_S5E4 = [0.001, 0.001, 0.001, 0.001, 0.05, 0.2, 1, 1, 1, 1]\n",
    "\n",
    "#AngleTransition_S4E5 = [1, 4, 6, 10, 15, 20, 25, 30, 40, 60]\n",
    "#HOS_S4E5 = [12, 11, 10, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5]\n",
    "#HES_S4E5 = [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]\n",
    "#EXPOSURE_S4E5 = [0.001, 0.001, 0.001, 0.001, 0.05, 0.1, 1, 1, 1, 1]\n",
    "\n",
    "#Consolodate lists\n",
    "##May need to update pending number of samples\n",
    "Sample5_En1 = pd.DataFrame([AngleTransition_S5E1, HOS_S5E1, HES_S5E1, EXPOSURE_S5E1]).T\n",
    "Sample5_En1.columns = ['Angle', 'HOS', 'HES', 'EXPOSURE']\n",
    "\n",
    "Sample5_En2 = pd.DataFrame([AngleTransition_S5E2, HOS_S5E2, HES_S5E2, EXPOSURE_S5E2]).T\n",
    "Sample5_En2.columns = ['Angle', 'HOS', 'HES', 'EXPOSURE']\n",
    "\n",
    "Sample5_En3 = pd.DataFrame([AngleTransition_S5E3, HOS_S5E3, HES_S5E3, EXPOSURE_S5E3]).T\n",
    "Sample5_En3.columns = ['Angle', 'HOS', 'HES', 'EXPOSURE']\n",
    "\n",
    "Sample5_En4 = pd.DataFrame([AngleTransition_S5E4, HOS_S5E4, HES_S5E4, EXPOSURE_S5E4]).T\n",
    "Sample5_En4.columns = ['Angle', 'HOS', 'HES', 'EXPOSURE']\n",
    "\n",
    "#Sample4_En5 = pd.DataFrame([AngleTransition_S4E5, HOS_S4E5, HES_S4E5, EXPOSURE_S4E5]).T\n",
    "#Sample4_En5.columns = ['Angle', 'HOS', 'HES', 'EXPOSURE']\n",
    "\n",
    "Sample5_motorpos = [Sample5_En1, Sample5_En2, Sample5_En3, Sample5_En4]#, Sample4_En5]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [],
   "source": [
    "\"\"\"\n",
    "\n",
    "Angle ranges corresponding to changing motor positions  \n",
    "         **Need to define for each sample**\n",
    "Length of angle transitions list is 1 more than the corresponding motor positions\n",
    "len(AngleTransition_X)-1 = len(HOS_X) = len(HES_X) = Len(EXPOSURE_X) (For Sample X)\n",
    "\n",
    "\"\"\"\n",
    "#########################################\n",
    "#####            Sample 6           #####\n",
    "#########################################\n",
    "AngleTransition_S6E1 = [1, 4, 6, 10, 15, 20, 25, 30, 40, 60]  \n",
    "HOS_S6E1 = [12, 11.5, 10.5, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5]\n",
    "HES_S6E1 = [100, 100, 100, 100, 100, 100, 100, 100, 500, 1000]\n",
    "EXPOSURE_S6E1 = [0.001, 0.001, 0.001, 0.001, 0.05, 0.1, 0.5, 1, 1, 1]\n",
    "\n",
    "AngleTransition_S6E2 = [1, 4, 6, 10, 15, 20, 25, 30, 40, 50, 60]\n",
    "HOS_S6E2 = [12, 11, 10, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5]\n",
    "HES_S6E2 = [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1500, 1500, 1500, 1500]\n",
    "EXPOSURE_S6E2 = [0.005, 0.005, 0.005, 0.005, 0.05, 0.3, 1, 1, 1, 2, 2]\n",
    "\n",
    "AngleTransition_S6E3 = [1, 4, 6, 10, 15, 20, 25, 30, 40, 50, 60]\n",
    "HOS_S6E3 = [12, 11, 10, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5]\n",
    "HES_S6E3 = [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1500, 1500, 1500, 1500]\n",
    "EXPOSURE_S6E3 = [0.005, 0.005, 0.005, 0.005, 0.05, 0.3, 1, 1, 1, 2, 2]\n",
    "\n",
    "AngleTransition_S6E4 = [1, 4, 6, 10, 15, 20, 25, 30, 40, 60] \n",
    "HOS_S6E4 = [12, 11, 10, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5]\n",
    "HES_S6E4 = [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1500, 1500]\n",
    "EXPOSURE_S6E4 = [0.001, 0.001, 0.001, 0.001, 0.05, 0.2, 1, 1, 1, 1]\n",
    "\n",
    "#AngleTransition_S4E5 = [1, 4, 6, 10, 15, 20, 25, 30, 40, 60]\n",
    "#HOS_S4E5 = [12, 11, 10, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5]\n",
    "#HES_S4E5 = [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]\n",
    "#EXPOSURE_S4E5 = [0.001, 0.001, 0.001, 0.001, 0.05, 0.1, 1, 1, 1, 1]\n",
    "\n",
    "#Consolodate lists\n",
    "##May need to update pending number of samples\n",
    "Sample6_En1 = pd.DataFrame([AngleTransition_S6E1, HOS_S6E1, HES_S6E1, EXPOSURE_S6E1]).T\n",
    "Sample6_En1.columns = ['Angle', 'HOS', 'HES', 'EXPOSURE']\n",
    "\n",
    "Sample6_En2 = pd.DataFrame([AngleTransition_S6E2, HOS_S6E2, HES_S6E2, EXPOSURE_S6E2]).T\n",
    "Sample6_En2.columns = ['Angle', 'HOS', 'HES', 'EXPOSURE']\n",
    "\n",
    "Sample6_En3 = pd.DataFrame([AngleTransition_S6E3, HOS_S6E3, HES_S6E3, EXPOSURE_S6E3]).T\n",
    "Sample6_En3.columns = ['Angle', 'HOS', 'HES', 'EXPOSURE']\n",
    "\n",
    "Sample6_En4 = pd.DataFrame([AngleTransition_S6E4, HOS_S6E4, HES_S6E4, EXPOSURE_S6E4]).T\n",
    "Sample6_En4.columns = ['Angle', 'HOS', 'HES', 'EXPOSURE']\n",
    "\n",
    "#Sample4_En5 = pd.DataFrame([AngleTransition_S4E5, HOS_S4E5, HES_S4E5, EXPOSURE_S4E5]).T\n",
    "#Sample4_En5.columns = ['Angle', 'HOS', 'HES', 'EXPOSURE']\n",
    "\n",
    "Sample6_motorpos = [Sample6_En1, Sample6_En2, Sample6_En3, Sample6_En4]#, Sample4_En5]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### here"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [],
   "source": [
    "VariableMotors = [Sample1_motorpos, Sample2_motorpos, Sample3_motorpos]#, Sample4_motorpos, Sample5_motorpos, Sample6_motorpos]#, Sample3]#, Sample2]\n",
    "SampleList = [sample1, sample2, sample3]#, sample4, sample5, sample6]#, Energy_sample3]#, Energy_Sample4\n",
    "\"\"\"\n",
    "\n",
    "No User input beyond this point, consoldating information into the appropriate lists for later use\n",
    "\n",
    "\"\"\"\n",
    "#Consolodate Information\n",
    "#For saving input metadata\n",
    "MotorPositionNames = ['XPosition', 'YPosition', 'ZPosition', 'ZFlipPosition', 'ZDirectBeam', 'ThetaOffset', 'ReverseHolder', 'SampleThickness', 'LowAngleDensity', 'HighAngleDensity', 'AngleCrossover', 'OverlapPoints', 'CheckUncertainty', 'HOSBuffer', 'I0Points']\n",
    "\n",
    "MotorValues = [XPosition, YPosition, ZPosition, ZFlipPosition, ZDirectBeam, ThetaOffset, ReverseHolder, SampleThickness, LowAngleDensity, HighAngleDensity, AngleCrossover, OverlapPoints, CheckUncertainty, HOSBuffer, I0Points]\n",
    "MotorPositions = pd.DataFrame(MotorValues).T\n",
    "#MotorPositions = MotorPositions.T\n",
    "MotorPositions.columns =MotorPositionNames"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [],
   "source": [
    "def AngleRunGeneration(MotorPositions, VariableMotors, Energy):\n",
    "    #Constants ## https://www.nist.gov/si-redefinition\n",
    "    SOL = 299792458 #m/s\n",
    "    PLANCK_JOULE = 6.6267015e-34 #Joule s\n",
    "    ELEMCHARGE =  1.602176634e-19 #coulombs\n",
    "    PLANCK = PLANCK_JOULE / ELEMCHARGE #eV s\n",
    "    meterToAng = 10**(10)\n",
    "    ##Initialization of needed components\n",
    "    Wavelength = SOL * PLANCK * meterToAng / Energy\n",
    "    AngleNumber = VariableMotors['Angle'].nunique()\n",
    "    XPosition = MotorPositions['XPosition']\n",
    "    YPosition = MotorPositions['YPosition']\n",
    "    ZPosition = MotorPositions['ZPosition']\n",
    "    Z180Position = MotorPositions['ZFlipPosition']\n",
    "    Zdelta = ZPosition - Z180Position\n",
    "    ThetaOffset = MotorPositions['ThetaOffset']\n",
    "    SampleThickness = MotorPositions['SampleThickness']\n",
    "    LowAngleDensity = MotorPositions['LowAngleDensity']\n",
    "    HighAngleDensity = MotorPositions['HighAngleDensity']\n",
    "    AngleCrossover = MotorPositions['AngleCrossover']\n",
    "    OverlapPoints = int(MotorPositions['OverlapPoints'])\n",
    "    for i in range(AngleNumber-1):\n",
    "        if i ==0: # starts the list\n",
    "            \n",
    "            ##Calculate the start and stop location for Q\n",
    "            AngleStart = VariableMotors['Angle'].iloc[i] # All of the relevant values are in terms of angles, but Q is calculated as a check\n",
    "            AngleStop = VariableMotors['Angle'].iloc[i+1]\n",
    "            QStart = 4*math.pi*math.sin(AngleStart*math.pi/180)/Wavelength\n",
    "            QStop = 4*math.pi*math.sin(AngleStop*math.pi/180)/Wavelength\n",
    "            \n",
    "            if AngleStop <= AngleCrossover:\n",
    "                AngleDensity=LowAngleDensity\n",
    "            else:\n",
    "                AngleDensity=HighAngleDensity\n",
    "                \n",
    "            #Setup dq in terms of an approximate fringe size (L = 2*PI/Thickness)\n",
    "            #Break it up based on the desired point density per fringe\n",
    "            dq=2*math.pi/(SampleThickness*AngleDensity)\n",
    "            QPoints = math.ceil((QStop-QStart)/dq) #Number of points to run is going to depend on fringe size\n",
    "            QList = np.linspace(QStart,QStop,QPoints).tolist() #Initialize the QList based on initial configuration\n",
    "            SampleTheta = np.linspace(AngleStart,AngleStop,QPoints) ##Begin generating list of 'Sample Theta' locations to take data\n",
    "            CCDTheta = SampleTheta*2 #Make corresponding CCDTheta positions\n",
    "            SampleTheta = SampleTheta+ThetaOffset #If running multiple samples in a row this will offset the sample theta based on alignment ##CCD THETA SHOULD NOT BE CHANGED\n",
    "            \n",
    "            #Check what side the sample is on. If on the bottom, sample theta starts @ -180\n",
    "            #if MotorPositions['ReverseHolder'] == 1:\n",
    "            #    SampleTheta=SampleTheta-180 # for samples on the backside of the holder, need to check and see if this is correct\n",
    "            \n",
    "            SampleX=[XPosition]*len(QList)\n",
    "            BeamLineEnergy=[Energy]*len(QList)\n",
    "            SampleY = YPosition+Zdelta/2+Zdelta/2*np.sin(SampleTheta*math.pi/180) #Adjust 'Sample Y' based on the relative axis of rotation\n",
    "            SampleZ = ZPosition+Zdelta/2*(np.cos(SampleTheta*math.pi/180)-1) #Adjust 'Sample Z' based on the relative axis of rotation\n",
    "\n",
    "            #Convert numpy arrays into lists for Pandas generation\n",
    "            SampleTheta=SampleTheta.tolist()\n",
    "            SampleY=SampleY.tolist()\n",
    "            SampleZ=SampleZ.tolist()\n",
    "            CCDTheta=CCDTheta.tolist()\n",
    "            \n",
    "            #Generate HOS / HES / Exposure lists for updating flux\n",
    "            HOSList=[VariableMotors['HOS'].iloc[i]]*len(QList)\n",
    "            HESList=[VariableMotors['HES'].iloc[i]]*len(QList)\n",
    "            ExposureList=[VariableMotors['EXPOSURE'].iloc[i]]*len(QList)\n",
    "            \n",
    "            #Adding points to assess the error in beam intensity given new HOS / HES / Exposure conditions\n",
    "            for d in range(int(MotorPositions['I0Points'])):\n",
    "                QList.insert(0,0)\n",
    "                #ThetaInsert = 0 if MotorPositions['ReverseHolder']==0 else -180\n",
    "                SampleTheta.insert(0,0)\n",
    "                CCDTheta.insert(0,0)\n",
    "                SampleX.insert(0,SampleX[d])\n",
    "                SampleY.insert(0,YPosition)\n",
    "                SampleZ.insert(0,MotorPositions['ZDirectBeam'])\n",
    "                HOSList.insert(0,HOSList[d])\n",
    "                HESList.insert(0, HESList[d])\n",
    "                ExposureList.insert(0,ExposureList[d])\n",
    "                BeamLineEnergy.insert(0,BeamLineEnergy[d])\n",
    "            \n",
    "        \n",
    "        else: # for all of the ranges after the first set of samples\n",
    "            ##Section is identical to the above\n",
    "            AngleStart=VariableMotors['Angle'].iloc[i]\n",
    "            AngleStop=VariableMotors['Angle'].iloc[i+1]\n",
    "            QStart=4*math.pi*math.sin(AngleStart*math.pi/180)/Wavelength\n",
    "            QStop=4*math.pi*math.sin(AngleStop*math.pi/180)/Wavelength\n",
    "            \n",
    "            if AngleStop <= AngleCrossover:\n",
    "                AngleDensity=LowAngleDensity\n",
    "            else:\n",
    "                AngleDensity=HighAngleDensity\n",
    "                \n",
    "            dq=2*math.pi/(SampleThickness*AngleDensity)\n",
    "            QPoints=math.ceil((QStop-QStart)/dq)\n",
    "            QListAddition=np.linspace(QStart,QStop,QPoints).tolist()\n",
    "            SampleThetaAddition=np.linspace(AngleStart,AngleStop,QPoints).tolist()\n",
    "            ##Calculate the points that are used to stitch datasets\n",
    "            #p+2 selects the appropriate number of points to repeat without doubling at the start of the angle range.\n",
    "            #Compensate the number of points by reducing OverlapPoints down by 1 (Nominally at 4)\n",
    "            for p in range(OverlapPoints):\n",
    "                QListAddition.insert(0,QList[-1*(p+2)]) #Add to Qlist\n",
    "                SampleThetaAddition.insert(0,SampleTheta[-1*(p+2)]-ThetaOffset) #Add to Sample Theta List ###QUICK CHANGE! REMOVE SAMPLE OFFSET TO ADDITION\n",
    "            SampleThetaAdditionArray=np.asarray(SampleThetaAddition) #Convert back to numpy array\n",
    "            \n",
    "            CCDThetaAddition=SampleThetaAdditionArray*2 #Calculate the CCD theta POsitions\n",
    "            CCDThetaAddition=CCDThetaAddition.tolist() #Convert to list\n",
    "            SampleThetaAdditionArray=SampleThetaAdditionArray+ThetaOffset #Account for theta offset\n",
    "            SampleThetaAddition = SampleThetaAdditionArray.tolist()\n",
    "            #Check what side the sample is on. If on the bottom, sample theta starts @ -180\n",
    "            #if MotorPositions['ReverseHolder']==1:\n",
    "            #    SampleThetaAdditionArray=SampleThetaAdditionArray-180\n",
    "            \n",
    "            SampleXAddition=[XPosition]*len(QListAddition)\n",
    "            BeamLineEnergyAddition=[Energy]*len(QListAddition)\n",
    "            SampleYAddition=YPosition+Zdelta/2+Zdelta/2*np.sin(SampleThetaAdditionArray*math.pi/180)\n",
    "            SampleZAddition=ZPosition+Zdelta/2*(np.cos(SampleThetaAdditionArray*math.pi/180)-1) \n",
    "            SampleYAddition=SampleYAddition.tolist()\n",
    "            SampleZAddition=SampleZAddition.tolist()\n",
    "            \n",
    "            #Generate HOS / HES / Exposure lists for updating flux\n",
    "            HOSListAddition=[VariableMotors['HOS'].iloc[i]]*len(QListAddition)\n",
    "            HESListAddition = [VariableMotors['HES'].iloc[i]]*len(QListAddition)\n",
    "            ExposureListAddition=[VariableMotors['EXPOSURE'].iloc[i]]*len(QListAddition)\n",
    "            \n",
    "            #Check to see if any of the variable motors have moved to add buffer points\n",
    "            if VariableMotors['HOS'].iloc[i] != VariableMotors['HOS'].iloc[i-1] or VariableMotors['HES'].iloc[i] != VariableMotors['HES'].iloc[i-1] or VariableMotors['EXPOSURE'].iloc[i] != VariableMotors['EXPOSURE'].iloc[i-1]:\n",
    "            #If a change is made, buffer the change with points to judge new counting statistics error and a few points to buffer the motor movements. \n",
    "            #Motor movements buffer is to make sure motors have fully moved before continuing data collection / may require post process changes\n",
    "            #Adding points to assess the error in beam intensity given new HOS / HES / Exposure conditions\n",
    "                for d in range(int(MotorPositions['CheckUncertainty'])):\n",
    "                    QListAddition.insert(0,QListAddition[d])\n",
    "                    SampleThetaAddition.insert(0,SampleThetaAddition[d])\n",
    "                    CCDThetaAddition.insert(0,CCDThetaAddition[d])\n",
    "                    SampleXAddition.insert(0,SampleXAddition[d])\n",
    "                    SampleYAddition.insert(0,SampleYAddition[d])\n",
    "                    SampleZAddition.insert(0,SampleZAddition[d])\n",
    "                    HOSListAddition.insert(0,HOSListAddition[d])\n",
    "                    HESListAddition.insert(0,HESListAddition[d])\n",
    "                    ExposureListAddition.insert(0,ExposureListAddition[d])\n",
    "                    BeamLineEnergyAddition.insert(0,BeamLineEnergyAddition[d])\n",
    "\n",
    "                #Adding dummy points to beginning of to account for HOS movement \n",
    "                for d in range(int(MotorPositions['HOSBuffer'])):\n",
    "                    QListAddition.insert(0,QListAddition[d])\n",
    "                    SampleThetaAddition.insert(0,SampleThetaAddition[d])\n",
    "                    CCDThetaAddition.insert(0,CCDThetaAddition[d])\n",
    "                    SampleXAddition.insert(0,SampleXAddition[d])\n",
    "                    SampleYAddition.insert(0,SampleYAddition[d])\n",
    "                    SampleZAddition.insert(0,SampleZAddition[d])\n",
    "                    HOSListAddition.insert(0,HOSListAddition[d])\n",
    "                    HESListAddition.insert(0,HESListAddition[d])\n",
    "                    ExposureListAddition.insert(0,ExposureListAddition[d])\n",
    "                    BeamLineEnergyAddition.insert(0,BeamLineEnergyAddition[d])\n",
    "            \n",
    "            QList.extend(QListAddition)\n",
    "            HOSList.extend(HOSListAddition)\n",
    "            HESList.extend(HESListAddition)\n",
    "            ExposureList.extend(ExposureListAddition)\n",
    "            SampleTheta.extend(SampleThetaAddition)\n",
    "            CCDTheta.extend(CCDThetaAddition)\n",
    "            SampleX.extend(SampleXAddition)\n",
    "            SampleY.extend(SampleYAddition)\n",
    "            SampleZ.extend(SampleZAddition)\n",
    "            BeamLineEnergy.extend(BeamLineEnergyAddition)\n",
    "        \n",
    "        #Check what side the sample is on. If on the bottom, sample theta starts @ -180\n",
    "    if MotorPositions['ReverseHolder'] == 1:\n",
    "        SampleTheta=[theta-180 for theta in SampleTheta] # for samples on the backside of the holder, need to check and see if this is correct\n",
    "\n",
    "            \n",
    "    return (SampleX, SampleY, SampleZ, SampleTheta, CCDTheta, HOSList, HESList, BeamLineEnergy, ExposureList, QList)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [],
   "source": [
    "##Generate the compiled dataframe for each sample\n",
    "\n",
    "AdjustableMotors = ['Sample X', 'Sample Y', 'Sample Z', 'Sample Theta', 'CCD Theta', 'Higher Order Suppressor', 'Horizontal Exit Slit Size', 'Beamline Energy', 'Exposure']\n",
    "RunFile = pd.DataFrame(columns = AdjustableMotors)\n",
    "#NumSamples = len(VariableMotors) #The number of variable motor scans corresponding to each sample location\n",
    "#NumEnergies = len(Energy) #The number of energies for each sample\n",
    "\n",
    "for i, Samp in enumerate(VariableMotors):\n",
    "    en_list = SampleList[i]\n",
    "    for j, loc in enumerate(Samp):\n",
    "        sampdf = pd.DataFrame()\n",
    "        samp_energy = np.round(float(en_list.iloc[j] + EnergyOffset),2)\n",
    "        MotorPos_En = AngleRunGeneration(MotorPositions.iloc[i], loc, samp_energy)\n",
    "        sampdf['Sample X'] = np.round(np.round(MotorPos_En[0], 4) + XOffset[i]*j , 4)\n",
    "        sampdf['Sample Y'] = np.round(MotorPos_En[1], 4)\n",
    "        sampdf['Sample Z'] = np.round(MotorPos_En[2], 4)\n",
    "        sampdf['Sample Theta'] = np.round(MotorPos_En[3], 4)\n",
    "        sampdf['CCD Theta'] = np.round(MotorPos_En[4], 4)\n",
    "        sampdf['Higher Order Suppressor'] = MotorPos_En[5]\n",
    "        sampdf['Horizontal Exit Slit Size'] = MotorPos_En[6]\n",
    "        sampdf['Beamline Energy'] = MotorPos_En[7]\n",
    "        sampdf['Exposure'] = MotorPos_En[8]\n",
    "\n",
    "        RunFile = RunFile.append(sampdf, ignore_index=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Sample X</th>\n",
       "      <th>Sample Y</th>\n",
       "      <th>Sample Z</th>\n",
       "      <th>Sample Theta</th>\n",
       "      <th>CCD Theta</th>\n",
       "      <th>Higher Order Suppressor</th>\n",
       "      <th>Horizontal Exit Slit Size</th>\n",
       "      <th>Beamline Energy</th>\n",
       "      <th>Exposure</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>36.52</td>\n",
       "      <td>-3.215</td>\n",
       "      <td>-2.0</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>12.0</td>\n",
       "      <td>150.0</td>\n",
       "      <td>270.0</td>\n",
       "      <td>0.001</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>36.52</td>\n",
       "      <td>-3.215</td>\n",
       "      <td>-2.0</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>12.0</td>\n",
       "      <td>150.0</td>\n",
       "      <td>270.0</td>\n",
       "      <td>0.001</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>36.52</td>\n",
       "      <td>-3.215</td>\n",
       "      <td>-2.0</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>12.0</td>\n",
       "      <td>150.0</td>\n",
       "      <td>270.0</td>\n",
       "      <td>0.001</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>36.52</td>\n",
       "      <td>-3.215</td>\n",
       "      <td>-2.0</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>12.0</td>\n",
       "      <td>150.0</td>\n",
       "      <td>270.0</td>\n",
       "      <td>0.001</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>36.52</td>\n",
       "      <td>-3.215</td>\n",
       "      <td>-2.0</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>12.0</td>\n",
       "      <td>150.0</td>\n",
       "      <td>270.0</td>\n",
       "      <td>0.001</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2098</th>\n",
       "      <td>0.45</td>\n",
       "      <td>0.000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>70.7576</td>\n",
       "      <td>141.5152</td>\n",
       "      <td>7.5</td>\n",
       "      <td>1500.0</td>\n",
       "      <td>288.7</td>\n",
       "      <td>0.500</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2099</th>\n",
       "      <td>0.45</td>\n",
       "      <td>0.000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>71.8182</td>\n",
       "      <td>143.6364</td>\n",
       "      <td>7.5</td>\n",
       "      <td>1500.0</td>\n",
       "      <td>288.7</td>\n",
       "      <td>0.500</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2100</th>\n",
       "      <td>0.45</td>\n",
       "      <td>0.000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>72.8788</td>\n",
       "      <td>145.7576</td>\n",
       "      <td>7.5</td>\n",
       "      <td>1500.0</td>\n",
       "      <td>288.7</td>\n",
       "      <td>0.500</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2101</th>\n",
       "      <td>0.45</td>\n",
       "      <td>0.000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>73.9394</td>\n",
       "      <td>147.8788</td>\n",
       "      <td>7.5</td>\n",
       "      <td>1500.0</td>\n",
       "      <td>288.7</td>\n",
       "      <td>0.500</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2102</th>\n",
       "      <td>0.45</td>\n",
       "      <td>0.000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>75.0000</td>\n",
       "      <td>150.0000</td>\n",
       "      <td>7.5</td>\n",
       "      <td>1500.0</td>\n",
       "      <td>288.7</td>\n",
       "      <td>0.500</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>2103 rows Ã— 9 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      Sample X  Sample Y  Sample Z  Sample Theta  CCD Theta  \\\n",
       "0        36.52    -3.215      -2.0        0.0000     0.0000   \n",
       "1        36.52    -3.215      -2.0        0.0000     0.0000   \n",
       "2        36.52    -3.215      -2.0        0.0000     0.0000   \n",
       "3        36.52    -3.215      -2.0        0.0000     0.0000   \n",
       "4        36.52    -3.215      -2.0        0.0000     0.0000   \n",
       "...        ...       ...       ...           ...        ...   \n",
       "2098      0.45     0.000       0.0       70.7576   141.5152   \n",
       "2099      0.45     0.000       0.0       71.8182   143.6364   \n",
       "2100      0.45     0.000       0.0       72.8788   145.7576   \n",
       "2101      0.45     0.000       0.0       73.9394   147.8788   \n",
       "2102      0.45     0.000       0.0       75.0000   150.0000   \n",
       "\n",
       "      Higher Order Suppressor  Horizontal Exit Slit Size  Beamline Energy  \\\n",
       "0                        12.0                      150.0            270.0   \n",
       "1                        12.0                      150.0            270.0   \n",
       "2                        12.0                      150.0            270.0   \n",
       "3                        12.0                      150.0            270.0   \n",
       "4                        12.0                      150.0            270.0   \n",
       "...                       ...                        ...              ...   \n",
       "2098                      7.5                     1500.0            288.7   \n",
       "2099                      7.5                     1500.0            288.7   \n",
       "2100                      7.5                     1500.0            288.7   \n",
       "2101                      7.5                     1500.0            288.7   \n",
       "2102                      7.5                     1500.0            288.7   \n",
       "\n",
       "      Exposure  \n",
       "0        0.001  \n",
       "1        0.001  \n",
       "2        0.001  \n",
       "3        0.001  \n",
       "4        0.001  \n",
       "...        ...  \n",
       "2098     0.500  \n",
       "2099     0.500  \n",
       "2100     0.500  \n",
       "2101     0.500  \n",
       "2102     0.500  \n",
       "\n",
       "[2103 rows x 9 columns]"
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "RunFile"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {},
   "outputs": [],
   "source": [
    "SaveFolder = 'C:/users/tjf2/Documents/'\n",
    "SaveName = 'TEST'\n",
    "\n",
    "Runfile_name = SaveFolder + SaveName\n",
    "\n",
    "HeaderFile = pd.concat(SampleList,axis=1)\n",
    "RunFile.to_csv((Runfile_name + '.txt'), index=False,sep='\\t')\n",
    "HeaderFile.to_csv((Runfile_name+'_HEADER.txt'), index=False,sep='\\t')\n",
    "\n",
    "###Cleanup the output -- Definitly better ways to do this....\n",
    "with open((Runfile_name + '.txt'), 'r') as f: #Loads the file into memory\n",
    "    lines = f.readlines()\n",
    "    \n",
    "lines[0] = lines[0].replace('\\tExposure' , '') #Remove the 'Exposure' header\n",
    "lines[-1] = lines[-1].replace('\\n', '') #Remove the last carriage return\n",
    "\n",
    "with open((Runfile_name + '.txt'), \"w\") as f: #Writes it back in\n",
    "    f.writelines(lines)\n",
    "    \n",
    "del lines #Remove it from memory (it can be large)\n"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
